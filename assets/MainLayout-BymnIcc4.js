import{c as q,a as m,h as S,b as A,g as D,i as U,e as B,l as G,r as x,w as I,o as oe,d as se,p as ie,f as re,j as ue,k as O,m as ce,n as de,q as j,s as fe,t as ve,u as he,v as le,x as E,y as H,z as me,A as pe,B as ge,C as we,D as ye,E as V,F as be,G as W,H as J,I as T,J as Se,Q as xe,K as Ce,L as X,M as Z}from"./index-En0IJpGG.js";import{Q as k,g as Q,a as ze,_ as Ie,u as _e,b as Te,c as We,U as z,d as M,t as ee}from"./_plugin-vue_export-helper-DPNOTR6C.js";import"./pinia-CkN5-1p5.js";const Le=q({name:"QToolbarTitle",props:{shrink:Boolean},setup(e,{slots:t}){const o=m(()=>"q-toolbar__title ellipsis"+(e.shrink===!0?" col-shrink":""));return()=>S("div",{class:o.value},A(t.default))}}),Be=q({name:"QToolbar",props:{inset:Boolean},setup(e,{slots:t}){const o=m(()=>"q-toolbar row no-wrap items-center"+(e.inset===!0?" q-toolbar--inset":""));return()=>S("div",{class:o.value,role:"toolbar"},A(t.default))}}),Ee=q({name:"QHeader",props:{modelValue:{type:Boolean,default:!0},reveal:Boolean,revealOffset:{type:Number,default:250},bordered:Boolean,elevated:Boolean,heightHint:{type:[String,Number],default:50}},emits:["reveal","focusin"],setup(e,{slots:t,emit:o}){const{proxy:{$q:a}}=D(),i=U(G,B);if(i===B)return console.error("QHeader needs to be child of QLayout"),B;const c=x(parseInt(e.heightHint,10)),d=x(!0),r=m(()=>e.reveal===!0||i.view.value.indexOf("H")!==-1||a.platform.is.ios&&i.isContainer.value===!0),l=m(()=>{if(e.modelValue!==!0)return 0;if(r.value===!0)return d.value===!0?c.value:0;const n=c.value-i.scroll.value.position;return n>0?n:0}),s=m(()=>e.modelValue!==!0||r.value===!0&&d.value!==!0),h=m(()=>e.modelValue===!0&&s.value===!0&&e.reveal===!0),y=m(()=>"q-header q-layout__section--marginal "+(r.value===!0?"fixed":"absolute")+"-top"+(e.bordered===!0?" q-header--bordered":"")+(s.value===!0?" q-header--hidden":"")+(e.modelValue!==!0?" q-layout--prevent-focus":"")),b=m(()=>{const n=i.rows.value.top,f={};return n[0]==="l"&&i.left.space===!0&&(f[a.lang.rtl===!0?"right":"left"]=`${i.left.size}px`),n[2]==="r"&&i.right.space===!0&&(f[a.lang.rtl===!0?"left":"right"]=`${i.right.size}px`),f});function v(n,f){i.update("header",n,f)}function p(n,f){n.value!==f&&(n.value=f)}function F({height:n}){p(c,n),v("size",n)}function L(n){h.value===!0&&p(d,!0),o("focusin",n)}I(()=>e.modelValue,n=>{v("space",n),p(d,!0),i.animate()}),I(l,n=>{v("offset",n)}),I(()=>e.reveal,n=>{n===!1&&p(d,e.modelValue)}),I(d,n=>{i.animate(),o("reveal",n)}),I(i.scroll,n=>{e.reveal===!0&&p(d,n.direction==="up"||n.position<=e.revealOffset||n.position-n.inflectionPoint<100)});const _={};return i.instances.header=_,e.modelValue===!0&&v("size",c.value),v("space",e.modelValue),v("offset",l.value),oe(()=>{i.instances.header===_&&(i.instances.header=void 0,v("size",0),v("offset",0),v("space",!1))}),()=>{const n=se(t.default,[]);return e.elevated===!0&&n.push(S("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),n.push(S(k,{debounce:0,onResize:F})),S("header",{class:y.value,style:b.value,onFocusin:L},n)}}}),He=q({name:"QPageContainer",setup(e,{slots:t}){const{proxy:{$q:o}}=D(),a=U(G,B);if(a===B)return console.error("QPageContainer needs to be child of QLayout"),B;ie(re,!0);const i=m(()=>{const c={};return a.header.space===!0&&(c.paddingTop=`${a.header.size}px`),a.right.space===!0&&(c[`padding${o.lang.rtl===!0?"Left":"Right"}`]=`${a.right.size}px`),a.footer.space===!0&&(c.paddingBottom=`${a.footer.size}px`),a.left.space===!0&&(c[`padding${o.lang.rtl===!0?"Right":"Left"}`]=`${a.left.size}px`),c});return()=>S("div",{class:"q-page-container",style:i.value},A(t.default))}}),De=q({name:"QLayout",props:{container:Boolean,view:{type:String,default:"hhh lpr fff",validator:e=>/^(h|l)h(h|r) lpr (f|l)f(f|r)$/.test(e.toLowerCase())},onScroll:Function,onScrollHeight:Function,onResize:Function},setup(e,{slots:t,emit:o}){const{proxy:{$q:a}}=D(),i=x(null),c=x(a.screen.height),d=x(e.container===!0?0:a.screen.width),r=x({position:0,direction:"down",inflectionPoint:0}),l=x(0),s=x(ue.value===!0?0:Q()),h=m(()=>"q-layout q-layout--"+(e.container===!0?"containerized":"standard")),y=m(()=>e.container===!1?{minHeight:a.screen.height+"px"}:null),b=m(()=>s.value!==0?{[a.lang.rtl===!0?"left":"right"]:`${s.value}px`}:null),v=m(()=>s.value!==0?{[a.lang.rtl===!0?"right":"left"]:0,[a.lang.rtl===!0?"left":"right"]:`-${s.value}px`,width:`calc(100% + ${s.value}px)`}:null);function p(u){if(e.container===!0||document.qScrollPrevented!==!0){const w={position:u.position.top,direction:u.direction,directionChanged:u.directionChanged,inflectionPoint:u.inflectionPoint.top,delta:u.delta.top};r.value=w,e.onScroll!==void 0&&o("scroll",w)}}function F(u){const{height:w,width:C}=u;let g=!1;c.value!==w&&(g=!0,c.value=w,e.onScrollHeight!==void 0&&o("scrollHeight",w),_()),d.value!==C&&(g=!0,d.value=C),g===!0&&e.onResize!==void 0&&o("resize",u)}function L({height:u}){l.value!==u&&(l.value=u,_())}function _(){if(e.container===!0){const u=c.value>l.value?Q():0;s.value!==u&&(s.value=u)}}let n=null;const f={instances:{},view:m(()=>e.view),isContainer:m(()=>e.container),rootRef:i,height:c,containerHeight:l,scrollbarWidth:s,totalWidth:m(()=>d.value+s.value),rows:m(()=>{const u=e.view.toLowerCase().split(" ");return{top:u[0].split(""),middle:u[1].split(""),bottom:u[2].split("")}}),header:O({size:0,offset:0,space:!1}),right:O({size:300,offset:0,space:!1}),footer:O({size:0,offset:0,space:!1}),left:O({size:300,offset:0,space:!1}),scroll:r,animate(){n!==null?clearTimeout(n):document.body.classList.add("q-body--layout-animate"),n=setTimeout(()=>{n=null,document.body.classList.remove("q-body--layout-animate")},155)},update(u,w,C){f[u][w]=C}};if(ie(G,f),Q()>0){let u=function(){g=null,P.classList.remove("hide-scrollbar")},w=function(){if(g===null){if(P.scrollHeight>a.screen.height)return;P.classList.add("hide-scrollbar")}else clearTimeout(g);g=setTimeout(u,300)},C=function(K){g!==null&&K==="remove"&&(clearTimeout(g),u()),window[`${K}EventListener`]("resize",w)},g=null;const P=document.body;I(()=>e.container!==!0?"add":"remove",C),e.container!==!0&&C("add"),ce(()=>{C("remove")})}return()=>{const u=de(t.default,[S(ze,{onScroll:p}),S(k,{onResize:F})]),w=S("div",{class:h.value,style:y.value,ref:e.container===!0?void 0:i,tabindex:-1},u);return e.container===!0?S("div",{class:"q-layout-container overflow-hidden",ref:i},[S(k,{onResize:L}),S("div",{class:"absolute-full",style:b.value},[S("div",{class:"scroll",style:v.value},[w])])]):w}}});function Fe(e){return ve()?(he(e),!0):!1}const R=new WeakMap,Ve=(...e)=>{var t;const o=e[0],a=(t=D())==null?void 0:t.proxy;if(a==null&&!le())throw new Error("injectLocal must be called in setup");return a&&R.has(a)&&o in R.get(a)?R.get(a)[o]:U(...e)},qe=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Oe=Object.prototype.toString,Pe=e=>Oe.call(e)==="[object Object]";function te(e){return e.endsWith("rem")?Number.parseFloat(e)*16:Number.parseFloat(e)}function $(e){return Array.isArray(e)?e:[e]}function Qe(e){return D()}function Me(e,t=!0,o){Qe()?j(e,o):t?e():fe(e)}function Re(e,t,o){return I(e,t,{...o,immediate:!0})}const Y=qe?window:void 0;function $e(e){var t;const o=H(e);return(t=o?.$el)!=null?t:o}function N(...e){const t=[],o=()=>{t.forEach(r=>r()),t.length=0},a=(r,l,s,h)=>(r.addEventListener(l,s,h),()=>r.removeEventListener(l,s,h)),i=m(()=>{const r=$(H(e[0])).filter(l=>l!=null);return r.every(l=>typeof l!="string")?r:void 0}),c=Re(()=>{var r,l;return[(l=(r=i.value)==null?void 0:r.map(s=>$e(s)))!=null?l:[Y].filter(s=>s!=null),$(H(i.value?e[1]:e[0])),$(pe(i.value?e[2]:e[1])),H(i.value?e[3]:e[2])]},([r,l,s,h])=>{if(o(),!r?.length||!l?.length||!s?.length)return;const y=Pe(h)?{...h}:h;t.push(...r.flatMap(b=>l.flatMap(v=>s.map(p=>a(b,v,p,y)))))},{flush:"post"}),d=()=>{c(),o()};return Fe(o),d}function ke(){const e=E(!1),t=D();return t&&j(()=>{e.value=!0},t),e}function Ne(e){const t=ke();return m(()=>(t.value,!!e()))}const Ae=Symbol("vueuse-ssr-width");function Ue(){const e=le()?Ve(Ae,null):null;return typeof e=="number"?e:void 0}function Ge(e,t={}){const{window:o=Y,ssrWidth:a=Ue()}=t,i=Ne(()=>o&&"matchMedia"in o&&typeof o.matchMedia=="function"),c=E(typeof a=="number"),d=E(),r=E(!1),l=s=>{r.value=s.matches};return me(()=>{if(c.value){c.value=!i.value;const s=H(e).split(",");r.value=s.some(h=>{const y=h.includes("not all"),b=h.match(/\(\s*min-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/),v=h.match(/\(\s*max-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/);let p=!!(b||v);return b&&p&&(p=a>=te(b[1])),v&&p&&(p=a<=te(v[1])),y?!p:p});return}i.value&&(d.value=o.matchMedia(H(e)),r.value=d.value.matches)}),N(d,"change",l,{passive:!0}),m(()=>r.value)}function je(e={}){const{window:t=Y,initialWidth:o=Number.POSITIVE_INFINITY,initialHeight:a=Number.POSITIVE_INFINITY,listenOrientation:i=!0,includeScrollbar:c=!0,type:d="inner"}=e,r=E(o),l=E(a),s=()=>{if(t)if(d==="outer")r.value=t.outerWidth,l.value=t.outerHeight;else if(d==="visual"&&t.visualViewport){const{width:y,height:b,scale:v}=t.visualViewport;r.value=Math.round(y*v),l.value=Math.round(b*v)}else c?(r.value=t.innerWidth,l.value=t.innerHeight):(r.value=t.document.documentElement.clientWidth,l.value=t.document.documentElement.clientHeight)};s(),Me(s);const h={passive:!0};if(N("resize",s,h),t&&d==="visual"&&t.visualViewport&&N(t.visualViewport,"resize",s,h),i){const y=Ge("(orientation: portrait)");I(y,()=>s())}return{width:r,height:l}}const Ye={class:"row items-center q-gutter-x-lg"},Ke={class:"content-wrapper"},Je={class:"device-warning-mask flex flex-center"},Xe={class:"window-warning-mask fixed-full flex flex-center"},ne=1280,ae=720,Ze={__name:"MainLayout",setup(e){const t=We(),o=_e(),a=o.manager,i=Te(),c=x(!1),d=x(!1),r=m(()=>d.value?c.value?"Disconnecting":"Connecting...":c.value?"Disconnect":"Connect");let l=new Uint8Array(0);async function s(){d.value=!0;try{c.value?await b():await y()}catch(n){console.error(n)}finally{d.value=!1}}function h(n){const f=n instanceof Uint8Array?n:new Uint8Array(n),u=new Uint8Array(l.length+f.length);u.set(l,0),u.set(f,l.length),l=u}async function y(){if(await a.connect({baudRate:25e4})){const f=await a.validateDevice({queryCommand:z.generateValidateFrame("WEBSITE"),response:z.generateValidateFrame("OK"),timeout:200});f.result===!0?(await M(10),await v(),c.value=!0,t.notify("device connected")):(a.disconnect(),c.value=!1,t.notify(`device invalidated: ${f.reason}`))}else{t.notify("Failed to open serial port");return}}async function b(){let n=z.generateValidateFrame("EXIT");a.sendRawData(n),i.setIsAvailable(!1),await M(30),await a.disconnect()&&(t.notify("device disconnected"),c.value=!1)}async function v(){a.off("receive",h),l=new Uint8Array(0),a.on("receive",h);const n=z.generateFetchInfoFrame();a.sendRawData(n),await M(50);let f=null,u=null;if(({cmd:u,data:f}=z.verify(l))===null){a.disconnect(),t.notify("device invalidated");return}if(u===z.CMD_BYTE.GET_CONFIG){let w=ee(f),C=ee(w[0].value);for(const g of C)switch(g.type){case z.CONFIG_BYTE.INFO:i.setInfo(g.value);break;case z.CONFIG_BYTE.PROFILE:i.setProfile(g.value);break;case z.CONFIG_BYTE.BRIGHTNESS:i.setBrightness(g.value);break;case z.CONFIG_BYTE.BUTTON:i.setAllButtonConfig(g.value);break}}a.off("receive",h)}const{width:p,height:F}=je(),L=x(!1),_=ge(()=>{if(!t.platform.is.edge&&!t.platform.is.chrome&&!t.platform.is.edgeChromium){alert("Please use a compatible browser(chrome)).");return}L.value=p.value<ne||F.value<ae},100);return oe(()=>{window.removeEventListener("resize",_)}),j(()=>{"serial"in navigator?console.log("Web Serial API supported."):alert("Web Serial API not supported. Please use a compatible browser(chrome))."),o.init(),window.addEventListener("resize",_),I(()=>c.value,n=>{o.setIsConnected(n)})}),(n,f)=>{const u=be("router-view");return ye(),we(De,{view:"hHh Lpr lFr"},{default:V(()=>[W(Ee,{elevated:"",class:"bg-black"},{default:V(()=>[W(Be,null,{default:V(()=>[W(Le,null,{default:V(()=>f[0]||(f[0]=[Se("Madtrace Toolbox")])),_:1}),T("div",Ye,[W(xe,{name:"circle",size:"18px",color:c.value?"green":"red",class:"serial-indicater"},null,8,["color"]),W(Ce,{class:"bg-white text-black",label:r.value,onClick:s,loading:d.value,disable:d.value},null,8,["label","loading","disable"])])]),_:1})]),_:1}),W(He,null,{default:V(()=>[T("div",Ke,[W(u),J(T("div",Je,f[1]||(f[1]=[T("div",{class:"warning-content text-center q-pa-lg"},[T("p",{class:"text-body1"},"Please connect device first.")],-1)]),512),[[X,!c.value]])])]),_:1}),J(T("div",Xe,[T("div",{class:"warning-content text-center q-pa-lg"},[T("p",{class:"text-body1"},"Please Resize Window atleast "+Z(ne)+" x "+Z(ae)+".")])],512),[[X,L.value]])]),_:1})}}},at=Ie(Ze,[["__scopeId","data-v-45e7f6ba"]]);export{at as default};
