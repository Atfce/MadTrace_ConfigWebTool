import{c as O,a as m,h as C,b as G,g as k,i as j,e as F,l as Y,r as z,w as T,o as ie,d as ue,p as le,f as ce,j as de,k as q,m as fe,n as ve,q as K,s as he,t as me,u as ge,v as se,x as H,y as R,z as pe,A as we,B as ye,C as be,D as Se,E as P,F as Ce,G as _e,H as E,I as X,J as I,Q as xe,K as ze,L as Z,M as ee}from"./index-DwN6MTFB.js";import{Q as A,g as Q,a as Ie,_ as Te,u as We,b as Be,c as Le,U as x,d as M,t as te}from"./_plugin-vue_export-helper-B7yQALRr.js";import"./pinia-CKoJeuDk.js";const Ee=O({name:"QToolbarTitle",props:{shrink:Boolean},setup(e,{slots:t}){const i=m(()=>"q-toolbar__title ellipsis"+(e.shrink===!0?" col-shrink":""));return()=>C("div",{class:i.value},G(t.default))}}),De=O({name:"QToolbar",props:{inset:Boolean},setup(e,{slots:t}){const i=m(()=>"q-toolbar row no-wrap items-center"+(e.inset===!0?" q-toolbar--inset":""));return()=>C("div",{class:i.value,role:"toolbar"},G(t.default))}}),Fe=O({name:"QHeader",props:{modelValue:{type:Boolean,default:!0},reveal:Boolean,revealOffset:{type:Number,default:250},bordered:Boolean,elevated:Boolean,heightHint:{type:[String,Number],default:50}},emits:["reveal","focusin"],setup(e,{slots:t,emit:i}){const{proxy:{$q:a}}=k(),n=j(Y,F);if(n===F)return console.error("QHeader needs to be child of QLayout"),F;const c=z(parseInt(e.heightHint,10)),r=z(!0),s=m(()=>e.reveal===!0||n.view.value.indexOf("H")!==-1||a.platform.is.ios&&n.isContainer.value===!0),u=m(()=>{if(e.modelValue!==!0)return 0;if(s.value===!0)return r.value===!0?c.value:0;const l=c.value-n.scroll.value.position;return l>0?l:0}),o=m(()=>e.modelValue!==!0||s.value===!0&&r.value!==!0),g=m(()=>e.modelValue===!0&&o.value===!0&&e.reveal===!0),y=m(()=>"q-header q-layout__section--marginal "+(s.value===!0?"fixed":"absolute")+"-top"+(e.bordered===!0?" q-header--bordered":"")+(o.value===!0?" q-header--hidden":"")+(e.modelValue!==!0?" q-layout--prevent-focus":"")),b=m(()=>{const l=n.rows.value.top,S={};return l[0]==="l"&&n.left.space===!0&&(S[a.lang.rtl===!0?"right":"left"]=`${n.left.size}px`),l[2]==="r"&&n.right.space===!0&&(S[a.lang.rtl===!0?"left":"right"]=`${n.right.size}px`),S});function h(l,S){n.update("header",l,S)}function p(l,S){l.value!==S&&(l.value=S)}function W({height:l}){p(c,l),h("size",l)}function B(l){g.value===!0&&p(r,!0),i("focusin",l)}T(()=>e.modelValue,l=>{h("space",l),p(r,!0),n.animate()}),T(u,l=>{h("offset",l)}),T(()=>e.reveal,l=>{l===!1&&p(r,e.modelValue)}),T(r,l=>{n.animate(),i("reveal",l)}),T(n.scroll,l=>{e.reveal===!0&&p(r,l.direction==="up"||l.position<=e.revealOffset||l.position-l.inflectionPoint<100)});const L={};return n.instances.header=L,e.modelValue===!0&&h("size",c.value),h("space",e.modelValue),h("offset",u.value),ie(()=>{n.instances.header===L&&(n.instances.header=void 0,h("size",0),h("offset",0),h("space",!1))}),()=>{const l=ue(t.default,[]);return e.elevated===!0&&l.push(C("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),l.push(C(A,{debounce:0,onResize:W})),C("header",{class:y.value,style:b.value,onFocusin:B},l)}}}),He=O({name:"QPageContainer",setup(e,{slots:t}){const{proxy:{$q:i}}=k(),a=j(Y,F);if(a===F)return console.error("QPageContainer needs to be child of QLayout"),F;le(ce,!0);const n=m(()=>{const c={};return a.header.space===!0&&(c.paddingTop=`${a.header.size}px`),a.right.space===!0&&(c[`padding${i.lang.rtl===!0?"Left":"Right"}`]=`${a.right.size}px`),a.footer.space===!0&&(c.paddingBottom=`${a.footer.size}px`),a.left.space===!0&&(c[`padding${i.lang.rtl===!0?"Right":"Left"}`]=`${a.left.size}px`),c});return()=>C("div",{class:"q-page-container",style:n.value},G(t.default))}}),Re=O({name:"QLayout",props:{container:Boolean,view:{type:String,default:"hhh lpr fff",validator:e=>/^(h|l)h(h|r) lpr (f|l)f(f|r)$/.test(e.toLowerCase())},onScroll:Function,onScrollHeight:Function,onResize:Function},setup(e,{slots:t,emit:i}){const{proxy:{$q:a}}=k(),n=z(null),c=z(a.screen.height),r=z(e.container===!0?0:a.screen.width),s=z({position:0,direction:"down",inflectionPoint:0}),u=z(0),o=z(de.value===!0?0:Q()),g=m(()=>"q-layout q-layout--"+(e.container===!0?"containerized":"standard")),y=m(()=>e.container===!1?{minHeight:a.screen.height+"px"}:null),b=m(()=>o.value!==0?{[a.lang.rtl===!0?"left":"right"]:`${o.value}px`}:null),h=m(()=>o.value!==0?{[a.lang.rtl===!0?"right":"left"]:0,[a.lang.rtl===!0?"left":"right"]:`-${o.value}px`,width:`calc(100% + ${o.value}px)`}:null);function p(d){if(e.container===!0||document.qScrollPrevented!==!0){const w={position:d.position.top,direction:d.direction,directionChanged:d.directionChanged,inflectionPoint:d.inflectionPoint.top,delta:d.delta.top};s.value=w,e.onScroll!==void 0&&i("scroll",w)}}function W(d){const{height:w,width:f}=d;let v=!1;c.value!==w&&(v=!0,c.value=w,e.onScrollHeight!==void 0&&i("scrollHeight",w),L()),r.value!==f&&(v=!0,r.value=f),v===!0&&e.onResize!==void 0&&i("resize",d)}function B({height:d}){u.value!==d&&(u.value=d,L())}function L(){if(e.container===!0){const d=c.value>u.value?Q():0;o.value!==d&&(o.value=d)}}let l=null;const S={instances:{},view:m(()=>e.view),isContainer:m(()=>e.container),rootRef:n,height:c,containerHeight:u,scrollbarWidth:o,totalWidth:m(()=>r.value+o.value),rows:m(()=>{const d=e.view.toLowerCase().split(" ");return{top:d[0].split(""),middle:d[1].split(""),bottom:d[2].split("")}}),header:q({size:0,offset:0,space:!1}),right:q({size:300,offset:0,space:!1}),footer:q({size:0,offset:0,space:!1}),left:q({size:300,offset:0,space:!1}),scroll:s,animate(){l!==null?clearTimeout(l):document.body.classList.add("q-body--layout-animate"),l=setTimeout(()=>{l=null,document.body.classList.remove("q-body--layout-animate")},155)},update(d,w,f){S[d][w]=f}};if(le(Y,S),Q()>0){let d=function(){v=null,_.classList.remove("hide-scrollbar")},w=function(){if(v===null){if(_.scrollHeight>a.screen.height)return;_.classList.add("hide-scrollbar")}else clearTimeout(v);v=setTimeout(d,300)},f=function(V){v!==null&&V==="remove"&&(clearTimeout(v),d()),window[`${V}EventListener`]("resize",w)},v=null;const _=document.body;T(()=>e.container!==!0?"add":"remove",f),e.container!==!0&&f("add"),fe(()=>{f("remove")})}return()=>{const d=ve(t.default,[C(Ie,{onScroll:p}),C(A,{onResize:W})]),w=C("div",{class:g.value,style:y.value,ref:e.container===!0?void 0:n,tabindex:-1},d);return e.container===!0?C("div",{class:"q-layout-container overflow-hidden",ref:n},[C(A,{onResize:B}),C("div",{class:"absolute-full",style:b.value},[C("div",{class:"scroll",style:h.value},[w])])]):w}}}),ke="/MadTrace_ConfigWebTool/assets/logo-B6iLVUnQ.png";function Pe(e){return me()?(ge(e),!0):!1}const $=new WeakMap,Oe=(...e)=>{var t;const i=e[0],a=(t=k())==null?void 0:t.proxy;if(a==null&&!se())throw new Error("injectLocal must be called in setup");return a&&$.has(a)&&i in $.get(a)?$.get(a)[i]:j(...e)},Ve=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const qe=Object.prototype.toString,Me=e=>qe.call(e)==="[object Object]";function ne(e){return e.endsWith("rem")?Number.parseFloat(e)*16:Number.parseFloat(e)}function N(e){return Array.isArray(e)?e:[e]}function Qe(e){return k()}function $e(e,t=!0,i){Qe()?K(e,i):t?e():he(e)}function Ne(e,t,i){return T(e,t,{...i,immediate:!0})}const J=Ve?window:void 0;function Ae(e){var t;const i=R(e);return(t=i?.$el)!=null?t:i}function U(...e){const t=[],i=()=>{t.forEach(s=>s()),t.length=0},a=(s,u,o,g)=>(s.addEventListener(u,o,g),()=>s.removeEventListener(u,o,g)),n=m(()=>{const s=N(R(e[0])).filter(u=>u!=null);return s.every(u=>typeof u!="string")?s:void 0}),c=Ne(()=>{var s,u;return[(u=(s=n.value)==null?void 0:s.map(o=>Ae(o)))!=null?u:[J].filter(o=>o!=null),N(R(n.value?e[1]:e[0])),N(we(n.value?e[2]:e[1])),R(n.value?e[3]:e[2])]},([s,u,o,g])=>{if(i(),!s?.length||!u?.length||!o?.length)return;const y=Me(g)?{...g}:g;t.push(...s.flatMap(b=>u.flatMap(h=>o.map(p=>a(b,h,p,y)))))},{flush:"post"}),r=()=>{c(),i()};return Pe(i),r}function Ue(){const e=H(!1),t=k();return t&&K(()=>{e.value=!0},t),e}function Ge(e){const t=Ue();return m(()=>(t.value,!!e()))}const je=Symbol("vueuse-ssr-width");function Ye(){const e=se()?Oe(je,null):null;return typeof e=="number"?e:void 0}function Ke(e,t={}){const{window:i=J,ssrWidth:a=Ye()}=t,n=Ge(()=>i&&"matchMedia"in i&&typeof i.matchMedia=="function"),c=H(typeof a=="number"),r=H(),s=H(!1),u=o=>{s.value=o.matches};return pe(()=>{if(c.value){c.value=!n.value;const o=R(e).split(",");s.value=o.some(g=>{const y=g.includes("not all"),b=g.match(/\(\s*min-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/),h=g.match(/\(\s*max-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/);let p=!!(b||h);return b&&p&&(p=a>=ne(b[1])),h&&p&&(p=a<=ne(h[1])),y?!p:p});return}n.value&&(r.value=i.matchMedia(R(e)),s.value=r.value.matches)}),U(r,"change",u,{passive:!0}),m(()=>s.value)}function Je(e={}){const{window:t=J,initialWidth:i=Number.POSITIVE_INFINITY,initialHeight:a=Number.POSITIVE_INFINITY,listenOrientation:n=!0,includeScrollbar:c=!0,type:r="inner"}=e,s=H(i),u=H(a),o=()=>{if(t)if(r==="outer")s.value=t.outerWidth,u.value=t.outerHeight;else if(r==="visual"&&t.visualViewport){const{width:y,height:b,scale:h}=t.visualViewport;s.value=Math.round(y*h),u.value=Math.round(b*h)}else c?(s.value=t.innerWidth,u.value=t.innerHeight):(s.value=t.document.documentElement.clientWidth,u.value=t.document.documentElement.clientHeight)};o(),$e(o);const g={passive:!0};if(U("resize",o,g),t&&r==="visual"&&t.visualViewport&&U(t.visualViewport,"resize",o,g),n){const y=Ke("(orientation: portrait)");T(y,()=>o())}return{width:s,height:u}}const Xe={class:"row items-center q-gutter-x-lg"},Ze={class:"content-wrapper"},et={class:"device-warning-mask flex flex-center"},tt={class:"window-warning-mask fixed-full flex flex-center"},ae=1280,oe=720,nt={__name:"MainLayout",setup(e){const t=Le(),i=Ce(),a=We(),n=a.manager,c=Be(),r=z(!1),s=z(!1),u=m(()=>s.value?r.value?"Disconnecting":"Connecting...":r.value?"Disconnect":"Connect");let o=new Uint8Array(0);async function g(){s.value=!0;try{r.value?await h():await b()}catch(f){console.error(f)}finally{s.value=!1}}function y(f){const v=f instanceof Uint8Array?f:new Uint8Array(f),_=new Uint8Array(o.length+v.length);_.set(o,0),_.set(v,o.length),o=_}async function b(){if(await n.connect({baudRate:25e4})){const v=await n.validateDevice({queryCommand:x.generateValidateFrame("WEBSITE"),response:x.generateValidateFrame("OK"),timeout:200});v.result===!0?(await M(10),await p(),r.value=!0,t.notify("device connected")):(n.disconnect(),r.value=!1,t.notify(`device invalidated: ${v.reason}`))}else{t.notify("Failed to open serial port");return}}async function h(){let f=x.generateEnableDayBrightnessFrame(0);n.sendRawData(f),await M(10),f=x.generateValidateFrame("EXIT"),n.sendRawData(f),c.setIsAvailable(!1),await M(30),await n.disconnect()&&(t.notify("device disconnected"),r.value=!1)}async function p(){n.off("receive",y),o=new Uint8Array(0),n.on("receive",y);const f=x.generateFetchInfoFrame();n.sendRawData(f),await M(50);let v=null,_=null;if(({cmd:_,data:v}=x.verify(o))===null){n.disconnect(),t.notify("device invalidated");return}if(_===x.CMD_BYTE.GET_CONFIG){let V=te(v),re=te(V[0].value);for(const D of re)switch(D.type){case x.CONFIG_BYTE.INFO:c.setInfo(D.value);break;case x.CONFIG_BYTE.PROFILE:c.setProfile(D.value);break;case x.CONFIG_BYTE.BRIGHTNESS:c.setBrightness(D.value);break;case x.CONFIG_BYTE.BUTTON:c.setAllButtonConfig(D.value);break;case x.CONFIG_BYTE.RPM:c.setRpmConfig(D.value);break}}n.off("receive",y)}const W=z(0);let B=null;const L=()=>{r.value||(W.value+=1,B&&clearTimeout(B),B=setTimeout(()=>{W.value=0},500),W.value>=5&&(W.value=0,i.currentRoute.value.path==="/config"?i.push("/"):i.push("/config")))},{width:l,height:S}=Je(),d=z(!1),w=ye(()=>{if(!t.platform.is.edge&&!t.platform.is.chrome&&!t.platform.is.edgeChromium){alert("Please use a compatible browser(chrome)).");return}d.value=l.value<ae||S.value<oe},100);return ie(()=>{window.removeEventListener("resize",w)}),K(()=>{"serial"in navigator?console.log("Web Serial API supported."):alert("Web Serial API not supported. Please use a compatible browser(chrome))."),a.init(),window.addEventListener("resize",w),T(()=>r.value,f=>{a.setIsConnected(f)})}),(f,v)=>{const _=_e("router-view");return Se(),be(Re,{view:"hHh Lpr lFr"},{default:P(()=>[E(Fe,{elevated:"",class:"bg-black"},{default:P(()=>[E(De,null,{default:P(()=>[E(Ee,null,{default:P(()=>v[0]||(v[0]=[I("img",{src:ke,alt:"Madtrace",class:"logo"},null,-1)])),_:1}),I("div",Xe,[E(xe,{name:"circle",size:"18px",color:r.value?"green":"red",class:"serial-indicater",onClick:L},null,8,["color"]),E(ze,{class:"bg-white text-black",label:u.value,onClick:g,loading:s.value,disable:s.value},null,8,["label","loading","disable"])])]),_:1})]),_:1}),E(He,null,{default:P(()=>[I("div",Ze,[E(_),X(I("div",et,v[1]||(v[1]=[I("div",{class:"warning-content text-center q-pa-lg"},[I("p",{class:"text-body1"},"Please connect device first.")],-1)]),512),[[Z,!r.value]])])]),_:1}),X(I("div",tt,[I("div",{class:"warning-content text-center q-pa-lg"},[I("p",{class:"text-body1"},"Please Resize Window atleast "+ee(ae)+" x "+ee(oe)+".")])],512),[[Z,d.value]])]),_:1})}}},lt=Te(nt,[["__scopeId","data-v-302e83a0"]]);export{lt as default};
